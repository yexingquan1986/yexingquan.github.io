<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>财务成长性指标计算</title>
</head>

<body>
  <h1>高新技术企业认定财务成长性指标</h1>
  <form id="growthForm">
    <label for="year1">2022 年销售额：</label>
    <input type="number" id="year1Sales" step="0.01"><br>
    <label for="year1Assets">2022 年净资产：</label>
    <input type="number" id="year1Assets" step="0.01"><br><br>

    <label for="year2">2023 年销售额：</label>
    <input type="number" id="year2Sales" step="0.01"><br>
    <label for="year2Assets">2023 年净资产：</label>
    <input type="number" id="year2Assets" step="0.01"><br><br>

    <label for="year3">2024 年销售额：</label>
    <input type="number" id="year3Sales" step="0.01"><br>
    <label for="year3Assets">2024 年净资产：</label>
    <input type="number" id="year3Assets" step="0.01"><br><br>

    <button type="button" onclick="calculateGrowth()">计算成长性指标</button><br><br>

    <div id="result"></div>
  </form>

  <script>
    function calculateGrowth() {
      const year1Sales = parseFloat(document.getElementById('year1Sales').value);
      const year2Sales = parseFloat(document.getElementById('year2Sales').value);
      const year3Sales = parseFloat(document.getElementById('year3Sales').value);

      const year1Assets = parseFloat(document.getElementById('year1Assets').value);
      const year2Assets = parseFloat(document.getElementById('year2Assets').value);
      const year3Assets = parseFloat(document.getElementById('year3Assets').value);

      let isInvalidAssets = false;
      if (year1Assets <= 0 || year2Assets <= 0 || year3Assets <= 0) {
        isInvalidAssets = true;
      }

      let isInvalidSales = false;
      if (year2Sales <= 0) {
        isInvalidSales = true;
      }


      const salesGrowthRate = 0.5 * ((year2Sales / year1Sales) + (year3Sales / year2Sales)) - 1;
      const assetsGrowthRate = 0.5 * ((year2Assets / year1Assets) + (year3Assets / year2Assets)) - 1;

      const salesGrowthPercentage = (salesGrowthRate) * 100;
      const assetsGrowthPercentage = (assetsGrowthRate) * 100;

      const salesGrowthTT = ((0.7 - ((year2Sales - year1Sales) / year1Sales)) * year2Sales) + year2Sales;
      const assetsGrowthTT = ((0.7 - ((year2Assets - year1Assets) / year1Assets)) * year2Assets) + year2Assets;

      const salesScore = calculateScore(salesGrowthRate);
      const assetsScore = calculateScore(assetsGrowthRate);

      let resultHTML = `
        <h2>销售增长率得分：${salesScore}</h2>
        <h2>销售增长率：${salesGrowthPercentage.toFixed(2)}%</h2>
        <h2>2024 年满分数值销售收入：${salesGrowthTT.toFixed(2)}</h2>
        <h2>净资产增长率得分：${assetsScore}</h2>
        <h2>净资产增长率：${assetsGrowthPercentage.toFixed(2)}%</h2>
        <h2>2024 年满分数值净资产：${assetsGrowthTT.toFixed(2)}</h2>
      `;

      if (isInvalidAssets) {
        resultHTML += `<h2>企业净资产增长率或销售收入增长率为负的，按0分计算。；第二年末净资产或销售收入为0的，按0分计算。</h2>`;
      }

      if (isInvalidSales) {
        resultHTML += `<h2>第二年末净资产或销售收入为0的，按0分计算。</h2>`;
      }

      document.getElementById('result').innerHTML = resultHTML;
    }

    function calculateScore(growthRate) {
      if (growthRate >= 0.35) {
        return '9 分至 10 分';
      } else if (growthRate >= 0.25) {
        return '7 分至 8 分';
      } else if (growthRate >= 0.15) {
        return '5 分至 6 分';
      } else if (growthRate >= 0.05) {
        return '3 分至 4 分';
      } else if (growthRate > 0) {
        return '1 分至 2 分';
      } else {
        return '0 分';
      }
    }
  </script>
</body>

</html>