<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>财务成长性指标计算</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-4 md:p-8">
    <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-md">
        <h1 class="text-2xl font-bold text-center mb-6 text-gray-800">高新技术企业认定财务成长性指标</h1>
        
        <form id="growth-form" class="space-y-4">
            <!-- 2022年数据 -->
            <div class="p-4 bg-gray-50 rounded-lg">
                <h2 class="text-lg font-semibold mb-3 text-gray-700">2022年数据</h2>
                <div>
                    <label for="year1Sales" class="block text-gray-700 mb-1">销售额：</label>
                    <input type="number" id="year1Sales" step="0.01" min="0.01" 
                           class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           required>
                </div>
                <div class="mt-3">
                    <label for="year1Assets" class="block text-gray-700 mb-1">净资产：</label>
                    <input type="number" id="year1Assets" step="0.01" min="0.01" 
                           class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           required>
                </div>
            </div>

            <!-- 2023年数据 -->
            <div class="p-4 bg-gray-50 rounded-lg">
                <h2 class="text-lg font-semibold mb-3 text-gray-700">2023年数据</h2>
                <div>
                    <label for="year2Sales" class="block text-gray-700 mb-1">销售额：</label>
                    <input type="number" id="year2Sales" step="0.01" min="0.01" 
                           class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           required>
                </div>
                <div class="mt-3">
                    <label for="year2Assets" class="block text-gray-700 mb-1">净资产：</label>
                    <input type="number" id="year2Assets" step="0.01" min="0.01" 
                           class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           required>
                </div>
            </div>

            <!-- 2024年数据 -->
            <div class="p-4 bg-gray-50 rounded-lg">
                <h2 class="text-lg font-semibold mb-3 text-gray-700">2024年数据</h2>
                <div>
                    <label for="year3Sales" class="block text-gray-700 mb-1">销售额：</label>
                    <input type="number" id="year3Sales" step="0.01" min="0.01" 
                           class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           required>
                </div>
                <div class="mt-3">
                    <label for="year3Assets" class="block text-gray-700 mb-1">净资产：</label>
                    <input type="number" id="year3Assets" step="0.01" min="0.01" 
                           class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" 
                           required>
                </div>
            </div>

            <button type="button" onclick="calculateGrowth()" 
                    class="mt-4 bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors w-full text-lg font-medium">
                计算成长性指标
            </button>

            <div id="result" class="mt-6 p-4 bg-gray-50 rounded-lg hidden"></div>
        </form>
    </div>

    <script>
        // 确保在DOM加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 为输入框添加最小值限制提示
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    if (this.value <= 0) {
                        this.setCustomValidity('请输入大于0的数值');
                    } else {
                        this.setCustomValidity('');
                    }
                });
            });
        });

        function calculateGrowth() {
            // 获取输入值并验证
            const year1Sales = parseFloat(document.getElementById('year1Sales').value) || 0;
            const year2Sales = parseFloat(document.getElementById('year2Sales').value) || 0;
            const year3Sales = parseFloat(document.getElementById('year3Sales').value) || 0;

            const year1Assets = parseFloat(document.getElementById('year1Assets').value) || 0;
            const year2Assets = parseFloat(document.getElementById('year2Assets').value) || 0;
            const year3Assets = parseFloat(document.getElementById('year3Assets').value) || 0;

            // 显示结果区域
            const resultDiv = document.getElementById('result');
            resultDiv.classList.remove('hidden');

            // 验证输入有效性
            let isValid = true;
            let errorMsg = '';
            
            if (year1Sales <= 0 || year2Sales <= 0 || year3Sales <= 0) {
                isValid = false;
                errorMsg += '所有年份的销售额必须大于0<br>';
            }
            
            if (year1Assets <= 0 || year2Assets <= 0 || year3Assets <= 0) {
                isValid = false;
                errorMsg += '所有年份的净资产必须大于0<br>';
            }

            if (!isValid) {
                resultDiv.innerHTML = `<div class="text-red-600 p-2">${errorMsg}</div>`;
                return;
            }

            // 计算增长率
            const salesGrowthRate = 0.5 * ((year2Sales / year1Sales) + (year3Sales / year2Sales)) - 1;
            const assetsGrowthRate = 0.5 * ((year2Assets / year1Assets) + (year3Assets / year2Assets)) - 1;

            // 计算百分比
            const salesGrowthPercentage = (salesGrowthRate) * 100;
            const assetsGrowthPercentage = (assetsGrowthRate) * 100;

            // 计算满分数值
            const salesGrowthTT = ((0.7 - ((year2Sales - year1Sales) / year1Sales)) * year2Sales) + year2Sales;
            const assetsGrowthTT = ((0.7 - ((year2Assets - year1Assets) / year1Assets)) * year2Assets) + year2Assets;

            // 计算得分
            const salesScore = calculateScore(salesGrowthRate);
            const assetsScore = calculateScore(assetsGrowthRate);

            // 构建结果HTML
            resultDiv.innerHTML = `
                <h2 class="text-xl font-semibold text-gray-800 mb-3 border-b pb-2">计算结果</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h3 class="font-medium text-blue-700">销售增长率</h3>
                        <p><strong>得分：</strong>${salesScore}</p>
                        <p><strong>增长率：</strong>${salesGrowthPercentage.toFixed(2)}%</p>
                        <p><strong>2024年满分数值：</strong>${salesGrowthTT.toFixed(2)}</p>
                    </div>
                    <div>
                        <h3 class="font-medium text-green-700">净资产增长率</h3>
                        <p><strong>得分：</strong>${assetsScore}</p>
                        <p><strong>增长率：</strong>${assetsGrowthPercentage.toFixed(2)}%</p>
                        <p><strong>2024年满分数值：</strong>${assetsGrowthTT.toFixed(2)}</p>
                    </div>
                </div>
            `;
        }

        // 计算得分的辅助函数
        function calculateScore(growthRate) {
            if (growthRate >= 0.35) {
                return '9-10分';
            } else if (growthRate >= 0.25) {
                return '7-8分';
            } else if (growthRate >= 0.15) {
                return '5-6分';
            } else if (growthRate >= 0.05) {
                return '3-4分';
            } else if (growthRate > 0) {
                return '1-2分';
            } else {
                return '0分';
            }
        }
    </script>
</body>
</html>
    
